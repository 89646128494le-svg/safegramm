# SafeGram Server (Go)

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –±—ç–∫–µ–Ω–¥ –¥–ª—è SafeGram –Ω–∞ Go.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚ö° **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—ã—Å—è—á –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, bcrypt —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- üí¨ **WebSocket**: –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- üóÑÔ∏è **PostgreSQL**: –ù–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- üöÄ **–ì–æ—Ç–æ–≤ –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é**: –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Go 1.21+
- PostgreSQL 12+
- Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
cd server-go

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
go mod download

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î (–∫–æ–≥–¥–∞ –±—É–¥—É—Ç –≥–æ—Ç–æ–≤—ã)
# go run cmd/migrate/main.go

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
go run main.go
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
PORT=8080
JWT_SECRET=your-secret-key-change-in-production
DATABASE_URL=postgres://user:password@localhost:5432/safegram?sslmode=disable
REDIS_URL=localhost:6379
NODE_ENV=development
```

## API Endpoints

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- `POST /api/auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /api/auth/login` - –í—Ö–æ–¥

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

- `GET /api/users/me` - –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `GET /api/users/search` - –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ß–∞—Ç—ã

- `GET /api/chats` - –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
- `POST /api/chats` - –°–æ–∑–¥–∞—Ç—å —á–∞—Ç
- `GET /api/chats/:id` - –ü–æ–ª—É—á–∏—Ç—å —á–∞—Ç
- `GET /api/chats/:id/messages` - –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞

### –°–æ–æ–±—â–µ–Ω–∏—è

- `POST /api/messages` - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
- `POST /api/messages/:id/react` - –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–∫—Ü–∏—é
- `POST /api/messages/:id/edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
- `POST /api/messages/:id/delete` - –£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ

### WebSocket

- `GET /ws` - WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–û–∂–∏–¥–∞–µ–º—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å 4 CPU / 8GB RAM:

- **RPS**: 10,000+ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- **WebSocket**: 50,000+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- **–ó–∞–¥–µ—Ä–∂–∫–∞**: <10ms –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ü–∞–º—è—Ç—å**: ~50-100MB –Ω–∞ –∏–Ω—Å—Ç–∞–Ω—Å

## Docker

```bash
docker build -t safegram-server-go .
docker run -p 8080:8080 --env-file .env safegram-server-go
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
2. ‚è≥ –ú–∏–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö API endpoints
3. ‚è≥ WebSocket —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
4. ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
5. ‚è≥ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ ScyllaDB –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
6. ‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

